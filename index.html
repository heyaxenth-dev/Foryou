<!doctype html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>A Special Surprise</title>
		<link rel="icon" href="favicon.svg" type="image/svg+xml" />
		<link
			href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Poppins:wght@300;400;600&display=swap"
			rel="stylesheet" />
		<style>
			:root {
				--primary-color: #ff4d6d;
				--secondary-color: #ff8fa3;
				--glass-bg: rgba(255, 255, 255, 0.25);
				--glass-border: rgba(255, 255, 255, 0.5);
				--text-color: #590d22;
			}

			* {
				margin: 0;
				padding: 0;
				box-sizing: border-box;
			}

			body {
				font-family: 'Poppins', sans-serif;
				background: linear-gradient(
					135deg,
					#ff9a9e 0%,
					#fecfef 99%,
					#fecfef 100%
				);
				height: 100vh;
				overflow: hidden;
				display: flex;
				justify-content: center;
				align-items: center;
				color: var(--text-color);
			}

			/* Ambient Background Animations */
			.bg-shapes {
				position: absolute;
				top: 0;
				left: 0;
				width: 100%;
				height: 100%;
				z-index: 0;
				pointer-events: none;
			}

			.shape {
				position: absolute;
				border-radius: 50%;
				background: rgba(255, 255, 255, 0.3);
				animation: float 20s infinite linear;
			}

			.shape:nth-child(1) {
				width: 150px;
				height: 150px;
				top: 10%;
				left: 10%;
				animation-duration: 25s;
			}

			.shape:nth-child(2) {
				width: 200px;
				height: 200px;
				bottom: 20%;
				right: 10%;
				animation-duration: 30s;
			}

			.shape:nth-child(3) {
				width: 100px;
				height: 100px;
				top: 40%;
				left: 50%;
				animation-duration: 35s;
			}

			@keyframes float {
				0% {
					transform: translate(0, 0) rotate(0deg);
				}

				50% {
					transform: translate(20px, 40px) rotate(180deg);
				}

				100% {
					transform: translate(0, 0) rotate(360deg);
				}
			}

			@keyframes fadeIn {
				from {
					opacity: 0;
					transform: translateY(-20px);
				}

				to {
					opacity: 1;
					transform: translateY(0);
				}
			}

			/* Birthday gate */
			#birthday-gate {
				position: absolute;
				top: 0;
				left: 0;
				width: 100%;
				height: 100%;
				display: flex;
				justify-content: center;
				align-items: center;
				z-index: 25;
				transition: opacity 0.4s ease;
			}
			#birthday-gate.gate-hidden {
				opacity: 0;
				pointer-events: none;
			}
			.birthday-gate-card {
				background: var(--glass-bg);
				backdrop-filter: blur(12px);
				border: 1px solid var(--glass-border);
				border-radius: 20px;
				padding: 2rem 2.5rem;
				text-align: center;
				box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
				max-width: 360px;
			}
			.birthday-gate-card h2 {
				font-family: 'Dancing Script', cursive;
				font-size: 1.75rem;
				color: var(--primary-color);
				margin-bottom: 0.5rem;
			}
			.birthday-gate-card p {
				color: var(--text-color);
				margin-bottom: 1.25rem;
				font-size: 0.95rem;
			}
			.birthday-gate-card .gate-pin {
				display: block;
				width: 100%;
				padding: 0.75rem 1rem;
				border: 2px solid var(--glass-border);
				border-radius: 10px;
				font-size: 1.5rem;
				font-family: inherit;
				margin-bottom: 1rem;
				background: rgba(255, 255, 255, 0.9);
				text-align: center;
				letter-spacing: 0.5em;
				caret-color: var(--primary-color);
			}
			.birthday-gate-card .gate-pin:focus {
				outline: none;
				border-color: var(--primary-color);
			}
			.birthday-gate-card .gate-pin::placeholder {
				letter-spacing: 0.4em;
				color: #999;
			}
			.birthday-gate-card .gate-btn {
				background: var(--primary-color);
				color: #fff;
				border: none;
				padding: 0.65rem 1.5rem;
				border-radius: 10px;
				font-size: 1rem;
				font-family: inherit;
				cursor: pointer;
				transition:
					transform 0.2s,
					background 0.2s;
			}
			.birthday-gate-card .gate-btn:hover {
				background: #e63946;
				transform: scale(1.02);
			}
			.birthday-gate-card .gate-error {
				color: #c1121f;
				font-size: 0.9rem;
				margin-top: 0.75rem;
				min-height: 1.25rem;
			}

			/* Envelope Stage */
			#envelope-stage.behind-gate {
				opacity: 0;
				pointer-events: none;
				visibility: hidden;
			}
			#envelope-stage {
				display: flex;
				flex-direction: column;
				align-items: center;
				justify-content: center;
				z-index: 20;
				opacity: 1;
				transition: opacity 1.5s ease;
				position: absolute;
				top: 50%;
				left: 50%;
				transform: translate(-50%, -50%);
				width: 100%;
			}

			.envelope-container {
				position: relative;
				cursor: pointer;
				transition: transform 0.5s ease;
			}

			.envelope-container:hover {
				transform: scale(1.05);
			}

			.envelope {
				width: 300px;
				height: 200px;
				background: #ff4d6d;
				border-radius: 10px;
				position: relative;
				box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
				display: flex;
				justify-content: center;
				align-items: center;
				overflow: hidden;
				transition: all 0.5s ease;
			}

			.flap {
				position: absolute;
				top: 0;
				left: 0;
				width: 0;
				height: 0;
				border-left: 150px solid transparent;
				border-right: 150px solid transparent;
				border-top: 110px solid #ff758f;
				/* Lighter shade */
				transform-origin: top;
				transition:
					transform 0.6s ease 0.5s,
					z-index 0.2s;
				z-index: 5;
			}

			.pocket {
				position: absolute;
				bottom: 0;
				left: 0;
				width: 0;
				height: 0;
				border-left: 150px solid transparent;
				border-right: 150px solid transparent;
				border-bottom: 200px solid #ff4d6d;
				z-index: 3;
			}

			.letter-preview {
				width: 260px;
				height: 180px;
				background: white;
				position: absolute;
				bottom: 0;
				border-radius: 5px;
				z-index: 2;
				transition: transform 0.8s ease 1s;
			}

			.seal {
				width: 40px;
				height: 40px;
				background: #d00000;
				border-radius: 50%;
				position: absolute;
				top: 80px;
				left: 130px;
				z-index: 6;
				display: flex;
				justify-content: center;
				align-items: center;
				color: #ffcccb;
				font-size: 1.2rem;
				font-weight: bold;
				box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
				transition: opacity 0.5s ease;
			}

			/* Open state for envelope */
			.envelope-container.open .flap {
				transform: rotateX(180deg);
				z-index: 1;
			}

			.envelope-container.open .seal {
				opacity: 0;
				pointer-events: none;
			}

			.envelope-container.open .letter-preview {
				transform: translateY(-100px);
				z-index: 4;
			}

			.open-btn {
				margin-top: 3rem;
				padding: 1rem 3rem;
				background: white;
				color: var(--primary-color);
				border: none;
				border-radius: 50px;
				font-size: 1.5rem;
				font-weight: bold;
				cursor: pointer;
				box-shadow: 0 5px 15px rgba(255, 77, 109, 0.4);
				transition: all 0.3s ease;
				font-family: 'Poppins', sans-serif;
			}

			.open-btn:hover {
				transform: translateY(-3px);
				box-shadow: 0 8px 20px rgba(255, 77, 109, 0.6);
				background: #fff0f3;
			}

			/* Full Letter View */
			#letter-view {
				position: fixed;
				top: 0;
				left: 0;
				width: 100%;
				height: 100%;
				background: rgba(0, 0, 0, 0.6);
				backdrop-filter: blur(5px);
				z-index: 50;
				display: none;
				justify-content: center;
				align-items: center;
				opacity: 0;
				transition: opacity 0.5s ease;
				overflow-y: auto;
				padding: 2rem 0;
			}

			#letter-view.active {
				display: flex;
				opacity: 1;
			}

			.love-letter {
				background: #fff;
				width: 90%;
				max-width: 600px;
				max-height: 90vh;
				overflow-y: auto;
				padding: 3rem;
				border-radius: 5px;
				box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
				position: relative;
				background-image: repeating-linear-gradient(
					white 0px,
					white 24px,
					#e9ecef 25px
				);
				line-height: 25px;
				transform: scale(0.8);
				transition: transform 0.5s ease;
			}

			#letter-view.active .love-letter {
				transform: scale(1);
			}

			.love-letter h2 {
				font-family: 'Dancing Script', cursive;
				font-size: 2.5rem;
				color: var(--primary-color);
				text-align: center;
				margin-bottom: 2rem;
			}

			.love-letter p {
				font-family: 'Dancing Script', cursive;
				font-size: 1.6rem;
				color: #333;
				margin-bottom: 1.5rem;
				line-height: 1.6;
			}

			.reply-link {
				color: var(--primary-color);
				font-weight: 600;
				text-decoration: underline;
				cursor: pointer;
				transition: color 0.2s ease;
			}

			.reply-link:hover {
				color: #e63946;
			}

			/* Reply page */
			#reply-page {
				position: absolute;
				inset: 0;
				display: flex;
				align-items: center;
				justify-content: center;
				opacity: 0;
				pointer-events: none;
				transition: opacity 0.4s ease;
			}

			#reply-page.visible {
				opacity: 1;
				pointer-events: auto;
			}

			.reply-card {
				background: #fff;
				padding: 2rem;
				border-radius: 16px;
				box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
				max-width: 420px;
				width: 90%;
			}

			.reply-title {
				font-family: 'Dancing Script', cursive;
				font-size: 2rem;
				color: var(--primary-color);
				text-align: center;
				margin-bottom: 0.5rem;
			}

			.reply-prompt {
				font-family: 'Poppins', sans-serif;
				font-size: 0.95rem;
				color: var(--text-color);
				margin-bottom: 1rem;
			}

			#reply-form textarea {
				width: 100%;
				max-width: 100%;
				padding: 0.75rem;
				font-family: 'Poppins', sans-serif;
				font-size: 1rem;
				border: 1px solid rgba(255, 77, 109, 0.4);
				border-radius: 8px;
				resize: vertical;
				min-height: 100px;
				box-sizing: border-box;
				display: block;
				margin-bottom: 1rem;
			}

			#reply-form textarea:focus {
				outline: none;
				border-color: var(--primary-color);
				box-shadow: 0 0 0 2px rgba(255, 77, 109, 0.2);
			}

			.send-reply-btn {
				width: 100%;
				padding: 0.6rem 1.25rem;
				border-radius: 8px;
				border: none;
				background: var(--primary-color);
				color: #fff;
				cursor: pointer;
				font-family: 'Poppins', sans-serif;
				font-size: 1rem;
				font-weight: 600;
				transition: background 0.2s ease;
			}

			.send-reply-btn:hover {
				background: #e63946;
			}

			/* Bouquet appreciation view */
			#bouquet-view {
				position: absolute;
				inset: 0;
				display: flex;
				align-items: center;
				justify-content: center;
				opacity: 0;
				pointer-events: none;
				transition: opacity 0.5s ease;
			}

			#bouquet-view.visible {
				opacity: 1;
				pointer-events: auto;
			}

			.bouquet-card {
				background: #fff;
				padding: 2.5rem;
				border-radius: 16px;
				box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
				text-align: center;
				max-width: 320px;
				animation: bouquetAppear 0.6s ease forwards;
			}

			@keyframes bouquetAppear {
				from {
					transform: scale(0.9);
					opacity: 0;
				}
				to {
					transform: scale(1);
					opacity: 1;
				}
			}

			.bouquet-display {
				margin-bottom: 1rem;
			}

			.bouquet-display .bouquet-img {
				display: block;
				max-width: 100%;
				width: 240px;
				height: auto;
				margin: 0 auto;
			}

			.bouquet-message {
				font-family: 'Poppins', sans-serif;
				font-weight: 600;
				font-size: 1.25rem;
				color: var(--text-color);
				margin-bottom: 0.5rem;
			}

			.bouquet-sub {
				font-family: 'Dancing Script', cursive;
				font-size: 1.2rem;
				color: #666;
				margin-bottom: 1.5rem;
			}

			.close-bouquet-btn {
				padding: 0.5rem 1.5rem;
				background: var(--primary-color);
				color: #fff;
				border: none;
				border-radius: 20px;
				font-family: 'Poppins', sans-serif;
				font-size: 1rem;
				font-weight: 600;
				cursor: pointer;
				transition: background 0.2s ease;
			}

			.close-bouquet-btn:hover {
				background: #e63946;
			}

			/* Sparkle animation for finding heart */
			.sparkle {
				position: absolute;
				pointer-events: none;
				animation: sparkleAnim 0.8s ease-out forwards;
				font-size: 20px;
				color: gold;
			}

			@keyframes sparkleAnim {
				0% {
					transform: scale(0) rotate(0deg);
					opacity: 1;
				}

				100% {
					transform: scale(2) rotate(180deg);
					opacity: 0;
				}
			}
		</style>
		<script>
			window.GITHUB_REPLIES = window.GITHUB_REPLIES || {
				user: 'heyaxenth-dev',
				repo: 'Foryou',
			};
		</script>
		<script src="config.js"></script>
	</head>

	<body>
		<!-- Background Shapes -->
		<div class="bg-shapes">
			<div class="shape"></div>
			<div class="shape"></div>
			<div class="shape"></div>
		</div>

		<!-- PIN gate (6-digit PIN from date 09-01-99 = 090199) -->
		<div id="birthday-gate">
			<div class="birthday-gate-card">
				<h2>For your eyes only</h2>
				<p>Enter the 6-digit PIN to continue.</p>
				<form id="birthday-form" onsubmit="return checkBirthday(event);">
					<input
						type="password"
						inputmode="numeric"
						pattern="[0-9]*"
						autocomplete="off"
						maxlength="6"
						placeholder="000000"
						class="gate-pin"
						id="birthday-input"
						required
						aria-label="6-digit PIN" />
					<button type="submit" class="gate-btn">Continue</button>
				</form>
				<p class="gate-error" id="birthday-error" aria-live="polite"></p>
			</div>
		</div>

		<!-- Envelope Stage -->
		<div id="envelope-stage" class="visible">
			<div class="envelope-container" id="envelope">
				<div class="envelope">
					<div class="pocket"></div>
					<!-- The letter inside -->
					<div class="letter-preview"></div>
					<div class="flap"></div>
					<div class="seal">❤️</div>
				</div>
			</div>
			<button class="open-btn" onclick="openEnvelope()">Open Me</button>
		</div>

		<!-- Full Letter View -->
		<div id="letter-view">
			<div class="love-letter" id="letter-content">
				<h2>Hi Kikay,</h2>
				<p>Happy Valentine's Day.</p>
				<p>
					This is the most impromtu letter I've ever created. Hehehe, I don't
					even know if this is appropriate and all, but I just want to say that
					I'm still here for you, no matter what.
				</p>
				<p>
					I just want to say that I'm grateful for the memories, the laughter,
					and even the lessons that came with loving you. No matter how things
					turned out, I'll always appreciate the time we shared. Thank you.
				</p>
				<p>
					I know life already drifted us apart. I just hope that you're doing
					well and that you're happy. Things may have changed but one this is
					constant, I still care for you. Always.
				</p>
				<p>
					I wanted to ask you something and if like, giving you a gift is still
					possible. I know I shouldn't do things the way it should be done or
					maybe I shouldn't do this at all. So this is me instead, in ways that
					I can, without overstepping boundaries. Anyways, I am still grateful
					to be able to witness you grow into the person you are today. I'm
					always proud of you po.
				</p>
				<p style="text-align: right">- H.X.</p>
				<p>
					if you're done reading this,
					<a
						href="#"
						class="reply-link"
						onclick="
							showReplyPage();
							return false;
						"
						>click here</a
					>
					to proceed, I have a little gift for you.
				</p>
			</div>
			<!-- Reply page (shown when user clicks "click here") -->
			<div id="reply-page" class="reply-page-hidden">
				<div class="reply-card">
					<h2 class="reply-title">Your reply</h2>
					<p class="reply-prompt">
						I'd love to hear from you. Write your reply below:
					</p>
					<form id="reply-form">
						<!-- Honeypot: leave empty. Bots often fill it; Formspree rejects those. -->
						<input
							type="text"
							name="_gotcha"
							id="formspree-gotcha"
							tabindex="-1"
							autocomplete="off"
							aria-hidden="true"
							style="
								position: absolute;
								left: -9999px;
								width: 1px;
								height: 1px;
								opacity: 0;
								pointer-events: none;
							" />
						<textarea
							id="reply-text"
							name="reply"
							rows="5"
							placeholder="Write your reply here..."
							required></textarea>
						<button type="submit" class="send-reply-btn">Send reply</button>
					</form>
				</div>
			</div>
			<!-- Bouquet appreciation (shown after reply is submitted) -->
			<div id="bouquet-view" class="bouquet-hidden">
				<div class="bouquet-card">
					<div class="bouquet-display">
						<img
							src="img/Tulips_Bouquet_Transparent_PNG_Clip_Art.png"
							alt="Tulip bouquet"
							class="bouquet-img" />
					</div>
					<p class="bouquet-message">Thank you!</p>
					<p class="bouquet-sub">Here's a bouquet for you — with love.</p>
					<button
						type="button"
						class="close-bouquet-btn"
						onclick="closeLetter()">
						Close
					</button>
				</div>
			</div>
		</div>

		<script>
			function checkBirthday(e) {
				e.preventDefault();
				var pin = (window.BIRTHDAY_GATE || '').toString().trim();
				if (!pin) {
					unlockLetter();
					return false;
				}
				var input = document.getElementById('birthday-input');
				var errEl = document.getElementById('birthday-error');
				var value = ((input && input.value) || '').replace(/\D/g, '');
				if (value.length !== 6) {
					if (errEl) errEl.textContent = 'Please enter 6 digits.';
					return false;
				}
				if (value === pin) {
					unlockLetter();
					return false;
				}
				if (errEl) errEl.textContent = 'Wrong PIN. Try again.';
				return false;
			}

			function unlockLetter() {
				document.getElementById('birthday-gate').classList.add('gate-hidden');
				document
					.getElementById('envelope-stage')
					.classList.remove('behind-gate');
			}

			function applyBirthdayGate() {
				var gate = document.getElementById('birthday-gate');
				var stage = document.getElementById('envelope-stage');
				if (!gate || !stage) return;
				var pin = (window.BIRTHDAY_GATE || '').toString().trim();
				var required = pin.length === 6;
				if (!required) {
					gate.classList.add('gate-hidden');
					stage.classList.remove('behind-gate');
				} else {
					stage.classList.add('behind-gate');
				}
			}

			function openEnvelope() {
				const envContainer = document.getElementById('envelope');
				const letterView = document.getElementById('letter-view');
				envContainer.classList.add('open');
				setTimeout(() => {
					letterView.classList.add('active');
					createConfetti();
				}, 1500);
			}

			function closeLetter() {
				document.getElementById('letter-view').classList.remove('active');
				const letterContent = document.getElementById('letter-content');
				const replyPage = document.getElementById('reply-page');
				const bouquetView = document.getElementById('bouquet-view');
				if (letterContent) letterContent.style.display = '';
				if (replyPage) replyPage.classList.remove('visible');
				if (bouquetView) bouquetView.classList.remove('visible');
			}

			function showReplyPage() {
				document.getElementById('letter-content').style.display = 'none';
				document.getElementById('reply-page').classList.add('visible');
			}

			async function handleReplySubmit(e) {
				e.preventDefault();
				const textarea = document.getElementById('reply-text');
				const reply = textarea && textarea.value ? textarea.value.trim() : '';
				if (!reply) return;
				const gotchaEl = document.getElementById('formspree-gotcha');
				const gotchaFilled = gotchaEl && (gotchaEl.value || '').trim() !== '';
				if (gotchaFilled) return;
				const apiUrl = (window.REPLY_API_URL || '').replace(/\/$/, '');
				const formId = window.FORMSPREE_FORM_ID || '';
				const btn = document.querySelector('.send-reply-btn');
				if (btn) {
					btn.disabled = true;
					btn.textContent = 'Sending…';
				}
				const sends = [];
				if (formId) {
					sends.push(
						fetch('https://formspree.io/f/' + formId, {
							method: 'POST',
							headers: { 'Content-Type': 'application/json' },
							body: JSON.stringify({
								reply: reply,
								_subject: 'Valentine reply',
								_submitted: new Date().toISOString(),
								_gotcha: (gotchaEl && gotchaEl.value) || '',
							}),
						}).catch(function () {}),
					);
				}
				if (apiUrl) {
					sends.push(
						fetch(apiUrl + '/api/append-reply', {
							method: 'POST',
							headers: { 'Content-Type': 'application/json' },
							body: JSON.stringify({ reply }),
						}).catch(function () {}),
					);
				}
				await Promise.all(sends);
				if (btn) {
					btn.disabled = false;
					btn.textContent = 'Send reply';
				}
				document.getElementById('reply-page').classList.remove('visible');
				document.getElementById('bouquet-view').classList.add('visible');
			}

			document.addEventListener('DOMContentLoaded', function () {
				applyBirthdayGate();
				var pinInput = document.getElementById('birthday-input');
				if (pinInput) {
					pinInput.addEventListener('input', function () {
						this.value = this.value.replace(/\D/g, '').slice(0, 6);
					});
				}
				var form = document.getElementById('reply-form');
				if (form) form.addEventListener('submit', handleReplySubmit);
			});

			function createConfetti() {
				const colors = ['#ff4d6d', '#ff8fa3', '#fff', '#gold'];
				for (let i = 0; i < 50; i++) {
					const conf = document.createElement('div');
					conf.style.position = 'fixed';
					conf.style.left = Math.random() * 100 + 'vw';
					conf.style.top = -10 + 'px';
					conf.style.width = '10px';
					conf.style.height = '10px';
					conf.style.backgroundColor =
						colors[Math.floor(Math.random() * colors.length)];
					conf.style.animation = `float ${Math.random() * 3 + 2}s linear forwards`;
					document.body.appendChild(conf);
					setTimeout(() => conf.remove(), 5000);
				}
			}
		</script>
	</body>
</html>
